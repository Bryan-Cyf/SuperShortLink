"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=void 0;var _objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),_extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),React=_interopRequireWildcard(require("react")),ReactDOM=_interopRequireWildcard(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_styles=require("@material-ui/styles"),_utils=require("@material-ui/utils"),_deprecatedPropType=_interopRequireDefault(require("../utils/deprecatedPropType")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_Portal=_interopRequireDefault(require("../Portal")),_createChainedFunction=_interopRequireDefault(require("../utils/createChainedFunction")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useEventCallback=_interopRequireDefault(require("../utils/useEventCallback")),_zIndex=_interopRequireDefault(require("../styles/zIndex")),_ModalManager=_interopRequireWildcard(require("./ModalManager")),_Unstable_TrapFocus=_interopRequireDefault(require("../Unstable_TrapFocus")),_SimpleBackdrop=_interopRequireDefault(require("./SimpleBackdrop"));function getContainer(e){return e="function"==typeof e?e():e,ReactDOM.findDOMNode(e)}function getHasTransition(e){return!!e.children&&e.children.props.hasOwnProperty("in")}var defaultManager=new _ModalManager.default,styles=function(e){return{root:{position:"fixed",zIndex:e.zIndex.modal,right:0,bottom:0,top:0,left:0},hidden:{visibility:"hidden"}}};exports.styles=styles;var Modal=React.forwardRef(function(e,t){function o(){return(0,_ownerDocument.default)(F.current)}function r(){return P.current.modalRef=w.current,P.current.mountNode=F.current,P.current}function a(){v.mount(r(),{disableScrollLock:q}),w.current.scrollTop=0}var n=(0,_styles.useTheme)(),l=(0,_styles.getThemeProps)({name:"MuiModal",props:(0,_extends2.default)({},e),theme:n}),i=l.BackdropComponent,u=void 0===i?_SimpleBackdrop.default:i,p=l.BackdropProps,d=l.children,s=l.closeAfterTransition,c=void 0!==s&&s,f=l.container,_=l.disableAutoFocus,b=void 0!==_&&_,y=l.disableBackdropClick,R=void 0!==y&&y,k=l.disableEnforceFocus,T=void 0!==k&&k,h=l.disableEscapeKeyDown,m=void 0!==h&&h,e=l.disablePortal,i=void 0!==e&&e,s=l.disableRestoreFocus,_=void 0!==s&&s,y=l.disableScrollLock,q=void 0!==y&&y,k=l.hideBackdrop,h=void 0!==k&&k,e=l.keepMounted,s=void 0!==e&&e,y=l.manager,v=void 0===y?defaultManager:y,C=l.onBackdropClick,D=l.onClose,E=l.onEscapeKeyDown,M=l.onRendered,g=l.open,k=(0,_objectWithoutProperties2.default)(l,["BackdropComponent","BackdropProps","children","closeAfterTransition","container","disableAutoFocus","disableBackdropClick","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","manager","onBackdropClick","onClose","onEscapeKeyDown","onRendered","open"]),e=React.useState(!0),y=e[0],x=e[1],P=React.useRef({}),F=React.useRef(null),w=React.useRef(null),t=(0,_useForkRef.default)(w,t),B=getHasTransition(l),I=(0,_useEventCallback.default)(function(){var e=getContainer(f)||o().body;v.add(r(),e),w.current&&a()}),K=React.useCallback(function(){return v.isTopModal(r())},[v]),l=(0,_useEventCallback.default)(function(e){(F.current=e)&&(M&&M(),g&&K()?a():(0,_ModalManager.ariaHidden)(w.current,!0))}),A=React.useCallback(function(){v.remove(r())},[v]);if(React.useEffect(function(){return function(){A()}},[A]),React.useEffect(function(){g?I():B&&c||A()},[g,A,B,c,I]),!s&&!g&&(!B||y))return null;s=styles(n||{zIndex:_zIndex.default}),n={};return void 0===d.props.tabIndex&&(n.tabIndex=d.props.tabIndex||"-1"),B&&(n.onEnter=(0,_createChainedFunction.default)(function(){x(!1)},d.props.onEnter),n.onExited=(0,_createChainedFunction.default)(function(){x(!0),c&&A()},d.props.onExited)),React.createElement(_Portal.default,{ref:l,container:f,disablePortal:i},React.createElement("div",(0,_extends2.default)({ref:t,onKeyDown:function(e){"Escape"===e.key&&K()&&(E&&E(e),m||(e.stopPropagation(),D&&D(e,"escapeKeyDown")))},role:"presentation"},k,{style:(0,_extends2.default)({},s.root,!g&&y?s.hidden:{},k.style)}),h?null:React.createElement(u,(0,_extends2.default)({open:g,onClick:function(e){e.target===e.currentTarget&&(C&&C(e),!R&&D&&D(e,"backdropClick"))}},p)),React.createElement(_Unstable_TrapFocus.default,{disableEnforceFocus:T,disableAutoFocus:b,disableRestoreFocus:_,getDoc:o,isEnabled:K,open:g},React.cloneElement(d,n))))});"production"!==process.env.NODE_ENV&&(Modal.propTypes={BackdropComponent:_propTypes.default.elementType,BackdropProps:_propTypes.default.object,children:_utils.elementAcceptingRef.isRequired,closeAfterTransition:_propTypes.default.bool,container:_propTypes.default.oneOfType([_utils.HTMLElementType,_propTypes.default.instanceOf(React.Component),_propTypes.default.func]),disableAutoFocus:_propTypes.default.bool,disableBackdropClick:(0,_deprecatedPropType.default)(_propTypes.default.bool,"Use the onClose prop with the `reason` argument to filter the `backdropClick` events."),disableEnforceFocus:_propTypes.default.bool,disableEscapeKeyDown:_propTypes.default.bool,disablePortal:_propTypes.default.bool,disableRestoreFocus:_propTypes.default.bool,disableScrollLock:_propTypes.default.bool,hideBackdrop:_propTypes.default.bool,keepMounted:_propTypes.default.bool,manager:_propTypes.default.object,onBackdropClick:(0,_deprecatedPropType.default)(_propTypes.default.func,"Use the onClose prop with the `reason` argument to handle the `backdropClick` events."),onClose:_propTypes.default.func,onEscapeKeyDown:(0,_deprecatedPropType.default)(_propTypes.default.func,"Use the onClose prop with the `reason` argument to handle the `escapeKeyDown` events."),onRendered:(0,_deprecatedPropType.default)(_propTypes.default.func,"Use the ref instead."),open:_propTypes.default.bool.isRequired});var _default=Modal;exports.default=_default;