"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.setTranslateValue=setTranslateValue,exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),ReactDOM=_interopRequireWildcard(require("react-dom")),_debounce=_interopRequireDefault(require("../utils/debounce")),_reactTransitionGroup=require("react-transition-group"),_utils=require("@material-ui/utils"),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_useTheme=_interopRequireDefault(require("../styles/useTheme")),_transitions=require("../styles/transitions"),_utils2=require("../transitions/utils");function getTranslateValue(e,t){var n,r=t.getBoundingClientRect(),i=0,o=0;return(n=t.fakeTransform||(n=window.getComputedStyle(t)).getPropertyValue("-webkit-transform")||n.getPropertyValue("transform"))&&"none"!==n&&"string"==typeof n&&(n=n.split("(")[1].split(")")[0].split(","),i=parseInt(n[4],10),o=parseInt(n[5],10)),"left"===e?"translateX(".concat(window.innerWidth,"px) translateX(").concat(i-r.left,"px)"):"right"===e?"translateX(-".concat(r.left+r.width-i,"px)"):"up"===e?"translateY(".concat(window.innerHeight,"px) translateY(").concat(o-r.top,"px)"):"translateY(-".concat(r.top+r.height-o,"px)")}function setTranslateValue(e,t){e=getTranslateValue(e,t);e&&(t.style.webkitTransform=e,t.style.transform=e)}var defaultTimeout={enter:_transitions.duration.enteringScreen,exit:_transitions.duration.leavingScreen},Slide=React.forwardRef(function(e,t){var n=e.children,r=e.direction,i=void 0===r?"down":r,o=e.in,a=e.onEnter,s=e.onEntered,u=e.onEntering,l=e.onExit,p=e.onExited,d=e.onExiting,f=e.style,c=e.timeout,_=void 0===c?defaultTimeout:c,T=e.TransitionComponent,y=void 0===T?_reactTransitionGroup.Transition:T,r=(0,_objectWithoutProperties2.default)(e,["children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),m=(0,_useTheme.default)(),g=React.useRef(null),c=React.useCallback(function(e){g.current=ReactDOM.findDOMNode(e)},[]),T=(0,_useForkRef.default)(n.ref,c),x=(0,_useForkRef.default)(T,t),e=function(t){return function(e){t&&(void 0===e?t(g.current):t(g.current,e))}},c=e(function(e,t){setTranslateValue(i,e),(0,_utils2.reflow)(e),a&&a(e,t)}),T=e(function(e,t){var n=(0,_utils2.getTransitionProps)({timeout:_,style:f},{mode:"enter"});e.style.webkitTransition=m.transitions.create("-webkit-transform",(0,_extends2.default)({},n,{easing:m.transitions.easing.easeOut})),e.style.transition=m.transitions.create("transform",(0,_extends2.default)({},n,{easing:m.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",u&&u(e,t)}),t=e(s),s=e(d),d=e(function(e){var t=(0,_utils2.getTransitionProps)({timeout:_,style:f},{mode:"exit"});e.style.webkitTransition=m.transitions.create("-webkit-transform",(0,_extends2.default)({},t,{easing:m.transitions.easing.sharp})),e.style.transition=m.transitions.create("transform",(0,_extends2.default)({},t,{easing:m.transitions.easing.sharp})),setTranslateValue(i,e),l&&l(e)}),e=e(function(e){e.style.webkitTransition="",e.style.transition="",p&&p(e)}),b=React.useCallback(function(){g.current&&setTranslateValue(i,g.current)},[i]);return React.useEffect(function(){if(!o&&"down"!==i&&"right"!==i){var e=(0,_debounce.default)(function(){g.current&&setTranslateValue(i,g.current)});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}}},[i,o]),React.useEffect(function(){o||b()},[o,b]),React.createElement(y,(0,_extends2.default)({nodeRef:g,onEnter:c,onEntered:t,onEntering:T,onExit:d,onExited:e,onExiting:s,appear:!0,in:o,timeout:_},r),function(e,t){return React.cloneElement(n,(0,_extends2.default)({ref:x,style:(0,_extends2.default)({visibility:"exited"!==e||o?void 0:"hidden"},f,n.props.style)},t))})});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:_utils.elementAcceptingRef,direction:_propTypes.default.oneOf(["down","left","right","up"]),in:_propTypes.default.bool,onEnter:_propTypes.default.func,onEntered:_propTypes.default.func,onEntering:_propTypes.default.func,onExit:_propTypes.default.func,onExited:_propTypes.default.func,onExiting:_propTypes.default.func,style:_propTypes.default.object,timeout:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.shape({appear:_propTypes.default.number,enter:_propTypes.default.number,exit:_propTypes.default.number})])});var _default=Slide;exports.default=_default;