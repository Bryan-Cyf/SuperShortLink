"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_debounce=_interopRequireDefault(require("../utils/debounce")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_deprecatedPropType=_interopRequireDefault(require("../utils/deprecatedPropType"));function getStyleValue(e,t){return parseInt(e[t],10)||0}var useEnhancedEffect="undefined"!=typeof window?React.useLayoutEffect:React.useEffect,styles={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}},TextareaAutosize=React.forwardRef(function(p,e){var t=p.onChange,r=p.rows,a=p.rowsMax,o=p.rowsMin,u=p.maxRows,n=p.minRows,s=void 0===n?1:n,l=p.style,i=p.value,n=(0,_objectWithoutProperties2.default)(p,["onChange","rows","rowsMax","rowsMin","maxRows","minRows","style","value"]),d=u||a,f=r||o||s,c=React.useRef(null!=i).current,y=React.useRef(null),o=(0,_useForkRef.default)(e,y),_=React.useRef(null),R=React.useRef(0),s=React.useState({}),e=s[0],T=s[1],h=React.useCallback(function(){var e=y.current,t=window.getComputedStyle(e),r=_.current;r.style.width=t.width,r.value=e.value||p.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");var a=t["box-sizing"],o=getStyleValue(t,"padding-bottom")+getStyleValue(t,"padding-top"),u=getStyleValue(t,"border-bottom-width")+getStyleValue(t,"border-top-width"),e=r.scrollHeight-o;r.value="x";t=r.scrollHeight-o,r=e;f&&(r=Math.max(Number(f)*t,r)),d&&(r=Math.min(Number(d)*t,r));var n=(r=Math.max(r,t))+("border-box"===a?o+u:0),s=Math.abs(r-e)<=1;T(function(e){return R.current<20&&(0<n&&1<Math.abs((e.outerHeightStyle||0)-n)||e.overflow!==s)?(R.current+=1,{overflow:s,outerHeightStyle:n}):("production"!==process.env.NODE_ENV&&20===R.current&&console.error(["Material-UI: Too many re-renders. The layout is unstable.","TextareaAutosize limits the number of renders to prevent an infinite loop."].join("\n")),e)})},[d,f,p.placeholder]);React.useEffect(function(){var e=(0,_debounce.default)(function(){R.current=0,h()});return window.addEventListener("resize",e),function(){e.clear(),window.removeEventListener("resize",e)}},[h]),useEnhancedEffect(function(){h()}),React.useEffect(function(){R.current=0},[i]);return React.createElement(React.Fragment,null,React.createElement("textarea",(0,_extends2.default)({value:i,onChange:function(e){R.current=0,c||h(),t&&t(e)},ref:o,rows:f,style:(0,_extends2.default)({height:e.outerHeightStyle,overflow:e.overflow?"hidden":null},l)},n)),React.createElement("textarea",{"aria-hidden":!0,className:p.className,readOnly:!0,ref:_,tabIndex:-1,style:(0,_extends2.default)({},styles.shadow,l)}))});"production"!==process.env.NODE_ENV&&(TextareaAutosize.propTypes={className:_propTypes.default.string,maxRows:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),minRows:_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),onChange:_propTypes.default.func,placeholder:_propTypes.default.string,rows:(0,_deprecatedPropType.default)(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),"Use `minRows` instead."),rowsMax:(0,_deprecatedPropType.default)(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),"Use `maxRows` instead."),rowsMin:(0,_deprecatedPropType.default)(_propTypes.default.oneOfType([_propTypes.default.number,_propTypes.default.string]),"Use `minRows` instead."),style:_propTypes.default.object,value:_propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.string),_propTypes.default.number,_propTypes.default.string])});var _default=TextareaAutosize;exports.default=_default;