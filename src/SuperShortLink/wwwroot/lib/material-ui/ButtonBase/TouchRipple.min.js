"use strict";var _interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard"),_interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.styles=exports.DELAY_RIPPLE=void 0;var _extends2=_interopRequireDefault(require("@babel/runtime/helpers/extends")),_toConsumableArray2=_interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray")),_objectWithoutProperties2=_interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties")),React=_interopRequireWildcard(require("react")),_propTypes=_interopRequireDefault(require("prop-types")),_reactTransitionGroup=require("react-transition-group"),_clsx=_interopRequireDefault(require("clsx")),_withStyles=_interopRequireDefault(require("../styles/withStyles")),_Ripple=_interopRequireDefault(require("./Ripple")),DURATION=550,DELAY_RIPPLE=80;exports.DELAY_RIPPLE=DELAY_RIPPLE;var styles=function(e){return{root:{overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"},ripple:{opacity:0,position:"absolute"},rippleVisible:{opacity:.3,transform:"scale(1)",animation:"$enter ".concat(DURATION,"ms ").concat(e.transitions.easing.easeInOut)},ripplePulsate:{animationDuration:"".concat(e.transitions.duration.shorter,"ms")},child:{opacity:1,display:"block",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"currentColor"},childLeaving:{opacity:0,animation:"$exit ".concat(DURATION,"ms ").concat(e.transitions.easing.easeInOut)},childPulsate:{position:"absolute",left:0,top:0,animation:"$pulsate 2500ms ".concat(e.transitions.easing.easeInOut," 200ms infinite")},"@keyframes enter":{"0%":{transform:"scale(0)",opacity:.1},"100%":{transform:"scale(1)",opacity:.3}},"@keyframes exit":{"0%":{opacity:1},"100%":{opacity:0}},"@keyframes pulsate":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.92)"},"100%":{transform:"scale(1)"}}}};exports.styles=styles;var TouchRipple=React.forwardRef(function(e,t){var r=e.center,p=void 0!==r&&r,n=e.classes,i=e.className,a=(0,_objectWithoutProperties2.default)(e,["center","classes","className"]),r=React.useState([]),e=r[0],u=r[1],o=React.useRef(0),l=React.useRef(null);React.useEffect(function(){l.current&&(l.current(),l.current=null)},[e]);var f=React.useRef(!1),d=React.useRef(null),h=React.useRef(null),R=React.useRef(null);React.useEffect(function(){return function(){clearTimeout(d.current)}},[]);var m=React.useCallback(function(e){var t=e.pulsate,r=e.rippleX,i=e.rippleY,a=e.rippleSize,e=e.cb;u(function(e){return[].concat((0,_toConsumableArray2.default)(e),[React.createElement(_Ripple.default,{key:o.current,classes:n,timeout:DURATION,pulsate:t,rippleX:r,rippleY:i,rippleSize:a})])}),o.current+=1,l.current=e},[n]),s=React.useCallback(function(){var e,t,r,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0,u=a.pulsate,o=void 0!==u&&u,l=a.center,s=void 0===l?p||a.pulsate:l,c=a.fakeElement,u=void 0!==c&&c;"mousedown"===i.type&&f.current?f.current=!1:("touchstart"===i.type&&(f.current=!0),a=(l=u?null:R.current)?l.getBoundingClientRect():{width:0,height:0,left:0,top:0},t=s||0===i.clientX&&0===i.clientY||!i.clientX&&!i.touches?(e=Math.round(a.width/2),Math.round(a.height/2)):(u=(c=i.touches?i.touches[0]:i).clientX,c=c.clientY,e=Math.round(u-a.left),Math.round(c-a.top)),s?(r=Math.sqrt((2*Math.pow(a.width,2)+Math.pow(a.height,2))/3))%2==0&&(r+=1):(a=2*Math.max(Math.abs((l?l.clientWidth:0)-e),e)+2,l=2*Math.max(Math.abs((l?l.clientHeight:0)-t),t)+2,r=Math.sqrt(Math.pow(a,2)+Math.pow(l,2))),i.touches?null===h.current&&(h.current=function(){m({pulsate:o,rippleX:e,rippleY:t,rippleSize:r,cb:n})},d.current=setTimeout(function(){h.current&&(h.current(),h.current=null)},DELAY_RIPPLE)):m({pulsate:o,rippleX:e,rippleY:t,rippleSize:r,cb:n}))},[p,m]),c=React.useCallback(function(){s({},{pulsate:!0})},[s]),_=React.useCallback(function(e,t){return clearTimeout(d.current),"touchend"===e.type&&h.current?(e.persist(),h.current(),h.current=null,void(d.current=setTimeout(function(){_(e,t)}))):(h.current=null,u(function(e){return 0<e.length?e.slice(1):e}),void(l.current=t))},[]);return React.useImperativeHandle(t,function(){return{pulsate:c,start:s,stop:_}},[c,s,_]),React.createElement("span",(0,_extends2.default)({className:(0,_clsx.default)(n.root,i),ref:R},a),React.createElement(_reactTransitionGroup.TransitionGroup,{component:null,exit:!0},e))});"production"!==process.env.NODE_ENV&&(TouchRipple.propTypes={center:_propTypes.default.bool,classes:_propTypes.default.object.isRequired,className:_propTypes.default.string});var _default=(0,_withStyles.default)(styles,{flip:!1,name:"MuiTouchRipple"})(React.memo(TouchRipple));exports.default=_default;