"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_interopRequireWildcard=require("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var React=_interopRequireWildcard(require("react")),ReactDOM=_interopRequireWildcard(require("react-dom")),_propTypes=_interopRequireDefault(require("prop-types")),_ownerDocument=_interopRequireDefault(require("../utils/ownerDocument")),_useForkRef=_interopRequireDefault(require("../utils/useForkRef")),_utils=require("@material-ui/utils");function Unstable_TrapFocus(e){var t=e.children,r=e.disableAutoFocus,u=void 0!==r&&r,r=e.disableEnforceFocus,o=void 0!==r&&r,r=e.disableRestoreFocus,c=void 0!==r&&r,r=e.getDoc,a=e.isEnabled,s=e.open,i=React.useRef(),l=React.useRef(null),d=React.useRef(null),p=React.useRef(),f=React.useRef(null),e=React.useCallback(function(e){f.current=ReactDOM.findDOMNode(e)},[]),e=(0,_useForkRef.default)(t.ref,e),n=React.useRef();return React.useEffect(function(){n.current=s},[s]),!n.current&&s&&"undefined"!=typeof window&&(p.current=r().activeElement),React.useEffect(function(){if(s){var t=(0,_ownerDocument.default)(f.current);u||!f.current||f.current.contains(t.activeElement)||(f.current.hasAttribute("tabIndex")||("production"!==process.env.NODE_ENV&&console.error(["Material-UI: The modal content node does not accept focus.",'For the benefit of assistive technologies, the tabIndex of the node is being set to "-1".'].join("\n")),f.current.setAttribute("tabIndex",-1)),f.current.focus());var e=function(){null!==f.current&&(t.hasFocus()&&!o&&a()&&!i.current?f.current&&!f.current.contains(t.activeElement)&&f.current.focus():i.current=!1)},r=function(e){!o&&a()&&9===e.keyCode&&t.activeElement===f.current&&(i.current=!0,(e.shiftKey?d:l).current.focus())};t.addEventListener("focus",e,!0),t.addEventListener("keydown",r,!0);var n=setInterval(function(){e()},50);return function(){clearInterval(n),t.removeEventListener("focus",e,!0),t.removeEventListener("keydown",r,!0),c||(p.current&&p.current.focus&&p.current.focus(),p.current=null)}}},[u,o,c,a,s]),React.createElement(React.Fragment,null,React.createElement("div",{tabIndex:0,ref:l,"data-test":"sentinelStart"}),React.cloneElement(t,{ref:e}),React.createElement("div",{tabIndex:0,ref:d,"data-test":"sentinelEnd"}))}"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes={children:_propTypes.default.node,disableAutoFocus:_propTypes.default.bool,disableEnforceFocus:_propTypes.default.bool,disableRestoreFocus:_propTypes.default.bool,getDoc:_propTypes.default.func.isRequired,isEnabled:_propTypes.default.func.isRequired,open:_propTypes.default.bool.isRequired}),"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes=(0,_utils.exactProp)(Unstable_TrapFocus.propTypes));var _default=Unstable_TrapFocus;exports.default=_default;