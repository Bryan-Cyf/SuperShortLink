import*as React from"react";import*as ReactDOM from"react-dom";import PropTypes from"prop-types";import ownerDocument from"../utils/ownerDocument";import useForkRef from"../utils/useForkRef";import{exactProp}from"@material-ui/utils";function Unstable_TrapFocus(e){var t=e.children,r=e.disableAutoFocus,o=void 0!==r&&r,r=e.disableEnforceFocus,c=void 0!==r&&r,r=e.disableRestoreFocus,s=void 0!==r&&r,r=e.getDoc,u=e.isEnabled,a=e.open,i=React.useRef(),l=React.useRef(null),f=React.useRef(null),p=React.useRef(),d=React.useRef(null),e=React.useCallback(function(e){d.current=ReactDOM.findDOMNode(e)},[]),e=useForkRef(t.ref,e),n=React.useRef();return React.useEffect(function(){n.current=a},[a]),!n.current&&a&&"undefined"!=typeof window&&(p.current=r().activeElement),React.useEffect(function(){if(a){var t=ownerDocument(d.current);o||!d.current||d.current.contains(t.activeElement)||(d.current.hasAttribute("tabIndex")||("production"!==process.env.NODE_ENV&&console.error(["Material-UI: The modal content node does not accept focus.",'For the benefit of assistive technologies, the tabIndex of the node is being set to "-1".'].join("\n")),d.current.setAttribute("tabIndex",-1)),d.current.focus());function e(){null!==d.current&&(t.hasFocus()&&!c&&u()&&!i.current?d.current&&!d.current.contains(t.activeElement)&&d.current.focus():i.current=!1)}function r(e){!c&&u()&&9===e.keyCode&&t.activeElement===d.current&&(i.current=!0,(e.shiftKey?f:l).current.focus())}t.addEventListener("focus",e,!0),t.addEventListener("keydown",r,!0);var n=setInterval(function(){e()},50);return function(){clearInterval(n),t.removeEventListener("focus",e,!0),t.removeEventListener("keydown",r,!0),s||(p.current&&p.current.focus&&p.current.focus(),p.current=null)}}},[o,c,s,u,a]),React.createElement(React.Fragment,null,React.createElement("div",{tabIndex:0,ref:l,"data-test":"sentinelStart"}),React.cloneElement(t,{ref:e}),React.createElement("div",{tabIndex:0,ref:f,"data-test":"sentinelEnd"}))}"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes={children:PropTypes.node,disableAutoFocus:PropTypes.bool,disableEnforceFocus:PropTypes.bool,disableRestoreFocus:PropTypes.bool,getDoc:PropTypes.func.isRequired,isEnabled:PropTypes.func.isRequired,open:PropTypes.bool.isRequired}),"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes=exactProp(Unstable_TrapFocus.propTypes));export default Unstable_TrapFocus;