import _extends from"@babel/runtime/helpers/esm/extends";import _slicedToArray from"@babel/runtime/helpers/esm/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import _typeof from"@babel/runtime/helpers/esm/typeof";import{formatMuiErrorMessage as _formatMuiErrorMessage}from"@material-ui/utils";import*as React from"react";import{isFragment}from"react-is";import PropTypes from"prop-types";import clsx from"clsx";import ownerDocument from"../utils/ownerDocument";import capitalize from"../utils/capitalize";import{refType}from"@material-ui/utils";import Menu from"../Menu/Menu";import{isFilled}from"../InputBase/utils";import useForkRef from"../utils/useForkRef";import useControlled from"../utils/useControlled";function areEqualValues(e,o){return"object"===_typeof(o)&&null!==o?e===o:String(e)===String(o)}function isEmpty(e){return null==e||"string"==typeof e&&!e.trim()}var SelectInput=React.forwardRef(function(e,o){var r=e["aria-label"],t=e.autoFocus,n=e.autoWidth,a=e.children,l=e.classes,s=e.className,i=e.defaultValue,p=e.disabled,u=e.displayEmpty,c=e.IconComponent,d=e.inputRef,m=e.labelId,f=e.MenuProps,y=void 0===f?{}:f,v=e.multiple,b=e.name,P=e.onBlur,h=e.onChange,T=e.onClose,E=e.onFocus,R=e.onOpen,g=e.open,x=e.readOnly,I=e.renderValue,C=e.SelectDisplayProps,M=void 0===C?{}:C,_=e.tabIndex,O=(e.type,e.value),F=e.variant,f=void 0===F?"standard":F,C=_objectWithoutProperties(e,["aria-label","autoFocus","autoWidth","children","classes","className","defaultValue","disabled","displayEmpty","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"]),F=useControlled({controlled:O,default:i,name:"Select"}),e=_slicedToArray(F,2),w=e[0],D=e[1],S=React.useRef(null),O=React.useState(null),j=O[0],i=O[1],N=React.useRef(null!=g).current,F=React.useState(),e=F[0],V=F[1],O=React.useState(!1),F=O[0],A=O[1],d=useForkRef(o,d);React.useImperativeHandle(d,function(){return{focus:function(){j.focus()},node:S.current,value:w}},[j,w]),React.useEffect(function(){t&&j&&j.focus()},[t,j]),React.useEffect(function(){if(j){var e=ownerDocument(j).getElementById(m);if(e){function o(){getSelection().isCollapsed&&j.focus()}return e.addEventListener("click",o),function(){e.removeEventListener("click",o)}}}},[m,j]);function k(e,o){e?R&&R(o):T&&T(o),N||(V(n?null:j.clientWidth),A(e))}var W,B,U=React.Children.toArray(a),L=null!==j&&(N?g:F);delete C["aria-invalid"];var q=[],K=!1,z=!1;(isFilled({value:w})||u)&&(I?W=I(w):K=!0);u=U.map(function(o){if(!React.isValidElement(o))return null;var e,t;if("production"!==process.env.NODE_ENV&&isFragment(o)&&console.error(["Material-UI: The Select component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n")),v){if(!Array.isArray(w))throw new Error("production"!==process.env.NODE_ENV?"Material-UI: The `value` prop must be an array when using the `Select` component with `multiple`.":_formatMuiErrorMessage(2));(e=w.some(function(e){return areEqualValues(e,o.props.value)}))&&K&&q.push(o.props.children)}else(e=areEqualValues(w,o.props.value))&&K&&(B=o.props.children);return e&&(z=!0),React.cloneElement(o,{"aria-selected":e?"true":void 0,onClick:function(e){var o,r;v||k(!1,e),v?(o=Array.isArray(w)?w.slice():[],-1===(r=w.indexOf(t.props.value))?o.push(t.props.value):o.splice(r,1)):o=t.props.value,t.props.onClick&&t.props.onClick(e),w!==o&&(D(o),h&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:o,name:b}}),h(e,t)))},onKeyUp:function(e){" "===e.key&&e.preventDefault(),o.props.onKeyUp&&o.props.onKeyUp(e)},role:"option",selected:e,value:void 0,"data-value":(t=o).props.value})});"production"!==process.env.NODE_ENV&&React.useEffect(function(){var e;z||v||""===w||(e=U.map(function(e){return e.props.value}),console.warn(["Material-UI: You have provided an out-of-range value `".concat(w,"` for the select ").concat(b?'(name="'.concat(b,'") '):"","component."),"Consider providing a value that matches one of the available options or ''.","The available values are ".concat(e.filter(function(e){return null!=e}).map(function(e){return"`".concat(e,"`")}).join(", ")||'""',".")].join("\n")))},[z,U,v,b,w]),K&&(W=v?q.join(", "):B);I=e;!n&&N&&j&&(I=j.clientWidth);e=void 0!==_?_:p?null:0,_=M.id||(b?"mui-component-select-".concat(b):void 0);return React.createElement(React.Fragment,null,React.createElement("div",_extends({className:clsx(l.root,l.select,l.selectMenu,l[f],s,p&&l.disabled),ref:i,tabIndex:e,role:"button","aria-disabled":p?"true":void 0,"aria-expanded":L?"true":void 0,"aria-haspopup":"listbox","aria-label":r,"aria-labelledby":[m,_].filter(Boolean).join(" ")||void 0,onKeyDown:function(e){x||-1!==[" ","ArrowUp","ArrowDown","Enter"].indexOf(e.key)&&(e.preventDefault(),k(!0,e))},onMouseDown:p||x?null:function(e){0===e.button&&(e.preventDefault(),j.focus(),k(!0,e))},onBlur:function(e){!L&&P&&(e.persist(),Object.defineProperty(e,"target",{writable:!0,value:{value:w,name:b}}),P(e))},onFocus:E},M,{id:_}),isEmpty(W)?React.createElement("span",{dangerouslySetInnerHTML:{__html:"&#8203;"}}):W),React.createElement("input",_extends({value:Array.isArray(w)?w.join(","):w,name:b,ref:S,"aria-hidden":!0,onChange:function(e){var o=U.map(function(e){return e.props.value}).indexOf(e.target.value);-1!==o&&(o=U[o],D(o.props.value),h&&h(e,o))},tabIndex:-1,className:l.nativeInput,autoFocus:t},C)),React.createElement(c,{className:clsx(l.icon,l["icon".concat(capitalize(f))],L&&l.iconOpen,p&&l.disabled)}),React.createElement(Menu,_extends({id:"menu-".concat(b||""),anchorEl:j,open:L,onClose:function(e){k(!1,e)}},y,{MenuListProps:_extends({"aria-labelledby":m,role:"listbox",disableListWrap:!0},y.MenuListProps),PaperProps:_extends({},y.PaperProps,{style:_extends({minWidth:I},null!=y.PaperProps?y.PaperProps.style:null)})}),u))});"production"!==process.env.NODE_ENV&&(SelectInput.propTypes={"aria-label":PropTypes.string,autoFocus:PropTypes.bool,autoWidth:PropTypes.bool,children:PropTypes.node,classes:PropTypes.object.isRequired,className:PropTypes.string,defaultValue:PropTypes.any,disabled:PropTypes.bool,displayEmpty:PropTypes.bool,IconComponent:PropTypes.elementType.isRequired,inputRef:refType,labelId:PropTypes.string,MenuProps:PropTypes.object,multiple:PropTypes.bool,name:PropTypes.string,onBlur:PropTypes.func,onChange:PropTypes.func,onClose:PropTypes.func,onFocus:PropTypes.func,onOpen:PropTypes.func,open:PropTypes.bool,readOnly:PropTypes.bool,renderValue:PropTypes.func,SelectDisplayProps:PropTypes.object,tabIndex:PropTypes.oneOfType([PropTypes.number,PropTypes.string]),type:PropTypes.any,value:PropTypes.any,variant:PropTypes.oneOf(["standard","outlined","filled"])});export default SelectInput;