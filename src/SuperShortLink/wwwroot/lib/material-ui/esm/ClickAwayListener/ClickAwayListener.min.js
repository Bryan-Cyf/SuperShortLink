import*as React from"react";import*as ReactDOM from"react-dom";import PropTypes from"prop-types";import ownerDocument from"../utils/ownerDocument";import useForkRef from"../utils/useForkRef";import useEventCallback from"../utils/useEventCallback";import{elementAcceptingRef,exactProp}from"@material-ui/utils";function mapEventPropToEvent(e){return e.substring(2).toLowerCase()}function clickedRootScrollbar(e){return document.documentElement.clientWidth<e.clientX||document.documentElement.clientHeight<e.clientY}function ClickAwayListener(e){var r=e.children,t=e.disableReactTree,n=void 0!==t&&t,t=e.mouseEvent,o=void 0===t?"onClick":t,c=e.onClickAway,t=e.touchEvent,u=void 0===t?"onTouchEnd":t,i=React.useRef(!1),a=React.useRef(null),s=React.useRef(!1),l=React.useRef(!1);React.useEffect(function(){return setTimeout(function(){s.current=!0},0),function(){s.current=!1}},[]);var e=React.useCallback(function(e){a.current=ReactDOM.findDOMNode(e)},[]),t=useForkRef(r.ref,e),p=useEventCallback(function(e){var t=l.current;l.current=!1,s.current&&a.current&&!clickedRootScrollbar(e)&&(i.current?i.current=!1:(e.composedPath?-1<e.composedPath().indexOf(a.current):!ownerDocument(a.current).documentElement.contains(e.target)||a.current.contains(e.target))||!n&&t||c(e))}),e=function(n){return function(e){l.current=!0;var t=r.props[n];t&&t(e)}},t={ref:t};return!1!==u&&(t[u]=e(u)),React.useEffect(function(){if(!1!==u){function e(){i.current=!0}var t=mapEventPropToEvent(u),n=ownerDocument(a.current);return n.addEventListener(t,p),n.addEventListener("touchmove",e),function(){n.removeEventListener(t,p),n.removeEventListener("touchmove",e)}}},[p,u]),!1!==o&&(t[o]=e(o)),React.useEffect(function(){if(!1!==o){var e=mapEventPropToEvent(o),t=ownerDocument(a.current);return t.addEventListener(e,p),function(){t.removeEventListener(e,p)}}},[p,o]),React.createElement(React.Fragment,null,React.cloneElement(r,t))}"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes={children:elementAcceptingRef.isRequired,disableReactTree:PropTypes.bool,mouseEvent:PropTypes.oneOf(["onClick","onMouseDown","onMouseUp",!1]),onClickAway:PropTypes.func.isRequired,touchEvent:PropTypes.oneOf(["onTouchEnd","onTouchStart",!1])}),"production"!==process.env.NODE_ENV&&(ClickAwayListener.propTypes=exactProp(ClickAwayListener.propTypes));export default ClickAwayListener;