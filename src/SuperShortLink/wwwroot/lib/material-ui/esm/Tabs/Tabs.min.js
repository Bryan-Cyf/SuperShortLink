import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import _defineProperty from"@babel/runtime/helpers/esm/defineProperty";import*as React from"react";import{isFragment}from"react-is";import PropTypes from"prop-types";import clsx from"clsx";import{refType}from"@material-ui/utils";import debounce from"../utils/debounce";import ownerWindow from"../utils/ownerWindow";import{getNormalizedScrollLeft,detectScrollType}from"../utils/scrollLeft";import animate from"../internal/animate";import ScrollbarSize from"./ScrollbarSize";import withStyles from"../styles/withStyles";import TabIndicator from"./TabIndicator";import TabScrollButton from"../TabScrollButton";import useEventCallback from"../utils/useEventCallback";import useTheme from"../styles/useTheme";var styles=function(e){return{root:{overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},vertical:{flexDirection:"column"},flexContainer:{display:"flex"},flexContainerVertical:{flexDirection:"column"},centered:{justifyContent:"center"},scroller:{position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},fixed:{overflowX:"hidden",width:"100%"},scrollable:{overflowX:"scroll",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},scrollButtons:{},scrollButtonsDesktop:_defineProperty({},e.breakpoints.down("xs"),{display:"none"}),indicator:{}}},Tabs=React.forwardRef(function(e,t){var o=e["aria-label"],r=e["aria-labelledby"],l=e.action,n=e.centered,a=void 0!==n&&n,i=e.children,c=e.classes,s=e.className,u=e.component,d=void 0===u?"div":u,p=e.indicatorColor,f=void 0===p?"secondary":p,m=e.onChange,n=e.orientation,b=void 0===n?"horizontal":n,u=e.ScrollButtonComponent,h=void 0===u?TabScrollButton:u,p=e.scrollButtons,v=void 0===p?"auto":p,y=e.selectionFollowsFocus,n=e.TabIndicatorProps,u=void 0===n?{}:n,T=e.TabScrollButtonProps,p=e.textColor,g=void 0===p?"inherit":p,w=e.value,n=e.variant,C=void 0===n?"standard":n,p=_objectWithoutProperties(e,["aria-label","aria-labelledby","action","centered","children","classes","className","component","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant"]),S=useTheme(),E="scrollable"===C,x="rtl"===S.direction,P="vertical"===b,R=P?"scrollTop":"scrollLeft",N=P?"top":"left",B=P?"bottom":"right",k=P?"clientHeight":"clientWidth",W=P?"height":"width";"production"!==process.env.NODE_ENV&&a&&E&&console.error('Material-UI: You can not use the `centered={true}` and `variant="scrollable"` properties at the same time on a `Tabs` component.');function L(){var e,t,o=U.current;return o&&(e=o.getBoundingClientRect(),e={clientWidth:o.clientWidth,scrollLeft:o.scrollLeft,scrollTop:o.scrollTop,scrollLeftNormalized:getNormalizedScrollLeft(o,S.direction),scrollWidth:o.scrollWidth,top:e.top,bottom:e.bottom,left:e.left,right:e.right}),!o||!1===w||0<(o=X.current.children).length&&(t=o[H.get(w)],"production"!==process.env.NODE_ENV&&(t||console.error(["Material-UI: The value provided to the Tabs component is invalid.","None of the Tabs' children match with `".concat(w,"`."),H.keys?"You can provide one of the following values: ".concat(Array.from(H.keys()).join(", "),"."):null].join("\n"))),t=t?t.getBoundingClientRect():null),{tabsMeta:e,tabMeta:t}}function _(e){animate(R,U.current,e)}function z(){K(-U.current[k])}function M(){K(U.current[k])}var n=React.useState(!1),D=n[0],F=n[1],e=React.useState({}),I=e[0],j=e[1],n=React.useState({start:!1,end:!1}),O=n[0],A=n[1],e=React.useState({overflow:"hidden",marginBottom:null}),n=e[0],V=e[1],H=new Map,U=React.useRef(null),X=React.useRef(null),Y=useEventCallback(function(){var e=L(),t=e.tabsMeta,o=e.tabMeta,e=0;o&&t&&(e=P?o.top-t.top+t.scrollTop:(r=x?t.scrollLeftNormalized+t.clientWidth-t.scrollWidth:t.scrollLeft,o.left-t.left+r));var r,e=(r={},_defineProperty(r,N,e),_defineProperty(r,W,o?o[W]:0),r);isNaN(I[N])||isNaN(I[W])?j(e):(o=Math.abs(I[N]-e[N]),r=Math.abs(I[W]-e[W]),(1<=o||1<=r)&&j(e))}),K=function(e){var t=U.current[R];P?t+=e:(t+=e*(x?-1:1),t*=x&&"reverse"===detectScrollType()?-1:1),_(t)},q=React.useCallback(function(e){V({overflow:null,marginBottom:-e})},[]),G=useEventCallback(function(){var e=L(),t=e.tabsMeta,o=e.tabMeta;o&&t&&(o[N]<t[N]?(e=t[R]+(o[N]-t[N]),_(e)):o[B]>t[B]&&(t=t[R]+(o[B]-t[B]),_(t)))}),J=useEventCallback(function(){var e,t,o,r,l,n;E&&"off"!==v&&(e=(n=U.current).scrollTop,t=n.scrollHeight,r=n.clientHeight,o=n.scrollWidth,n=n.clientWidth,n=P?(l=1<e,e<t-r-1):(r=getNormalizedScrollLeft(U.current,S.direction),l=x?r<o-n-1:1<r,x?1<r:r<o-n-1),l===O.start&&n===O.end||A({start:l,end:n}))});React.useEffect(function(){var e=debounce(function(){Y(),J()}),t=ownerWindow(U.current);return t.addEventListener("resize",e),function(){e.clear(),t.removeEventListener("resize",e)}},[Y,J]);var Q=React.useCallback(debounce(function(){J()}));React.useEffect(function(){return function(){Q.clear()}},[Q]),React.useEffect(function(){F(!0)},[]),React.useEffect(function(){Y(),J()}),React.useEffect(function(){G()},[G,I]),React.useImperativeHandle(l,function(){return{updateIndicator:Y,updateScrollButtons:J}},[Y,J]);var Z=React.createElement(TabIndicator,_extends({className:c.indicator,orientation:b,color:f},u,{style:_extends({},I,u.style)})),$=0,u=React.Children.map(i,function(e){if(!React.isValidElement(e))return null;"production"!==process.env.NODE_ENV&&isFragment(e)&&console.error(["Material-UI: The Tabs component doesn't accept a Fragment as a child.","Consider providing an array instead."].join("\n"));var t=void 0===e.props.value?$:e.props.value;H.set(t,$);var o=t===w;return $+=1,React.cloneElement(e,{fullWidth:"fullWidth"===C,indicator:o&&!D&&Z,selected:o,selectionFollowsFocus:y,onChange:m,textColor:g,value:t})}),i=function(){var e={};e.scrollbarSizeListener=E?React.createElement(ScrollbarSize,{className:c.scrollable,onChange:q}):null;var t=O.start||O.end,t=E&&("auto"===v&&t||"desktop"===v||"on"===v);return e.scrollButtonStart=t?React.createElement(h,_extends({orientation:b,direction:x?"right":"left",onClick:z,disabled:!O.start,className:clsx(c.scrollButtons,"on"!==v&&c.scrollButtonsDesktop)},T)):null,e.scrollButtonEnd=t?React.createElement(h,_extends({orientation:b,direction:x?"left":"right",onClick:M,disabled:!O.end,className:clsx(c.scrollButtons,"on"!==v&&c.scrollButtonsDesktop)},T)):null,e}();return React.createElement(d,_extends({className:clsx(c.root,s,P&&c.vertical),ref:t},p),i.scrollButtonStart,i.scrollbarSizeListener,React.createElement("div",{className:clsx(c.scroller,E?c.scrollable:c.fixed),style:n,ref:U,onScroll:Q},React.createElement("div",{"aria-label":o,"aria-labelledby":r,className:clsx(c.flexContainer,P&&c.flexContainerVertical,a&&!E&&c.centered),onKeyDown:function(e){var t=e.target;if("tab"===t.getAttribute("role")){var o=null,r="vertical"!==b?"ArrowLeft":"ArrowUp",l="vertical"!==b?"ArrowRight":"ArrowDown";switch("vertical"!==b&&"rtl"===S.direction&&(r="ArrowRight",l="ArrowLeft"),e.key){case r:o=t.previousElementSibling||X.current.lastChild;break;case l:o=t.nextElementSibling||X.current.firstChild;break;case"Home":o=X.current.firstChild;break;case"End":o=X.current.lastChild}null!==o&&(o.focus(),e.preventDefault())}},ref:X,role:"tablist"},u),D&&Z),i.scrollButtonEnd)});"production"!==process.env.NODE_ENV&&(Tabs.propTypes={action:refType,"aria-label":PropTypes.string,"aria-labelledby":PropTypes.string,centered:PropTypes.bool,children:PropTypes.node,classes:PropTypes.object,className:PropTypes.string,component:PropTypes.elementType,indicatorColor:PropTypes.oneOf(["primary","secondary"]),onChange:PropTypes.func,orientation:PropTypes.oneOf(["horizontal","vertical"]),ScrollButtonComponent:PropTypes.elementType,scrollButtons:PropTypes.oneOf(["auto","desktop","off","on"]),selectionFollowsFocus:PropTypes.bool,TabIndicatorProps:PropTypes.object,TabScrollButtonProps:PropTypes.object,textColor:PropTypes.oneOf(["inherit","primary","secondary"]),value:PropTypes.any,variant:PropTypes.oneOf(["fullWidth","scrollable","standard"])});export default withStyles(styles,{name:"MuiTabs"})(Tabs);export{styles};