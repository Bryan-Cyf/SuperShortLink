import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutProperties from"@babel/runtime/helpers/esm/objectWithoutProperties";import*as React from"react";import PropTypes from"prop-types";import PopperJs from"popper.js";import{chainPropTypes,refType,HTMLElementType}from"@material-ui/utils";import{useTheme}from"@material-ui/styles";import Portal from"../Portal";import createChainedFunction from"../utils/createChainedFunction";import setRef from"../utils/setRef";import useForkRef from"../utils/useForkRef";function flipPlacement(e,t){if("ltr"===(t&&t.direction||"ltr"))return e;switch(e){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return e}}function getAnchorEl(e){return"function"==typeof e?e():e}var useEnhancedEffect="undefined"!=typeof window?React.useLayoutEffect:React.useEffect,defaultPopperOptions={},Popper=React.forwardRef(function(e,t){var o=e.anchorEl,n=e.children,r=e.container,p=e.disablePortal,i=void 0!==p&&p,s=e.keepMounted,c=void 0!==s&&s,a=e.modifiers,u=e.open,l=e.placement,f=void 0===l?"bottom":l,p=e.popperOptions,d=void 0===p?defaultPopperOptions:p,s=e.popperRef,l=e.style,p=e.transition,m=void 0!==p&&p,e=_objectWithoutProperties(e,["anchorEl","children","container","disablePortal","keepMounted","modifiers","open","placement","popperOptions","popperRef","style","transition"]),h=React.useRef(null),y=useForkRef(h,t),T=React.useRef(null),P=useForkRef(T,s),b=React.useRef(P);useEnhancedEffect(function(){b.current=P},[P]),React.useImperativeHandle(s,function(){return T.current},[]);var t=React.useState(!0),s=t[0],E=t[1],R=flipPlacement(f,useTheme()),t=React.useState(R),f=t[0],v=t[1];React.useEffect(function(){T.current&&T.current.update()});function g(){T.current&&(T.current.destroy(),b.current(null))}var O=React.useCallback(function(){var e,t;h.current&&o&&u&&(T.current&&(T.current.destroy(),b.current(null)),t=function(e){v(e.placement)},e=getAnchorEl(o),"production"!==process.env.NODE_ENV&&e&&1===e.nodeType&&(e=e.getBoundingClientRect(),"test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom&&console.warn(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))),t=new PopperJs(getAnchorEl(o),h.current,_extends({placement:R},d,{modifiers:_extends({},i?{}:{preventOverflow:{boundariesElement:"window"}},a,d.modifiers),onCreate:createChainedFunction(t,d.onCreate),onUpdate:createChainedFunction(t,d.onUpdate)})),b.current(t))},[o,i,a,u,R,d]),t=React.useCallback(function(e){setRef(y,e),O()},[y,O]);if(React.useEffect(function(){return function(){g()}},[]),React.useEffect(function(){u||m||g()},[u,m]),!c&&!u&&(!m||s))return null;f={placement:f};return m&&(f.TransitionProps={in:u,onEnter:function(){E(!1)},onExited:function(){E(!0),g()}}),React.createElement(Portal,{disablePortal:i,container:r},React.createElement("div",_extends({ref:t,role:"tooltip"},e,{style:_extends({position:"fixed",top:0,left:0,display:u||!c||m?null:"none"},l)}),"function"==typeof n?n(f):n))});"production"!==process.env.NODE_ENV&&(Popper.propTypes={anchorEl:chainPropTypes(PropTypes.oneOfType([HTMLElementType,PropTypes.object,PropTypes.func]),function(e){if(e.open){var t=getAnchorEl(e.anchorEl);if(t&&1===t.nodeType){e=t.getBoundingClientRect();if("test"!==process.env.NODE_ENV&&0===e.top&&0===e.left&&0===e.right&&0===e.bottom)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join("\n"))}else if(!t||"number"!=typeof t.clientWidth||"number"!=typeof t.clientHeight||"function"!=typeof t.getBoundingClientRect)return new Error(["Material-UI: The `anchorEl` prop provided to the component is invalid.","It should be an HTML element instance or a referenceObject ","(https://popper.js.org/docs/v1/#referenceObject)."].join("\n"))}return null}),children:PropTypes.oneOfType([PropTypes.node,PropTypes.func]).isRequired,container:PropTypes.oneOfType([HTMLElementType,PropTypes.instanceOf(React.Component),PropTypes.func]),disablePortal:PropTypes.bool,keepMounted:PropTypes.bool,modifiers:PropTypes.object,open:PropTypes.bool.isRequired,placement:PropTypes.oneOf(["bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),popperOptions:PropTypes.object,popperRef:refType,style:PropTypes.object,transition:PropTypes.bool});export default Popper;