import _extends from"@babel/runtime/helpers/esm/extends";import _objectWithoutPropertiesLoose from"@babel/runtime/helpers/esm/objectWithoutPropertiesLoose";import*as React from"react";import PropTypes from"prop-types";import*as ReactDOM from"react-dom";import debounce from"../utils/debounce";import{Transition}from"react-transition-group";import{elementAcceptingRef}from"@material-ui/utils";import useForkRef from"../utils/useForkRef";import useTheme from"../styles/useTheme";import{duration}from"../styles/transitions";import{reflow,getTransitionProps}from"../transitions/utils";function getTranslateValue(e,t){var n=t.getBoundingClientRect();let r;if(t.fakeTransform)r=t.fakeTransform;else{const s=window.getComputedStyle(t);r=s.getPropertyValue("-webkit-transform")||s.getPropertyValue("transform")}let o=0,i=0;return r&&"none"!==r&&"string"==typeof r&&(t=r.split("(")[1].split(")")[0].split(","),o=parseInt(t[4],10),i=parseInt(t[5],10)),"left"===e?`translateX(${window.innerWidth}px) translateX(${o-n.left}px)`:"right"===e?`translateX(-${n.left+n.width-o}px)`:"up"===e?`translateY(${window.innerHeight}px) translateY(${i-n.top}px)`:`translateY(-${n.top+n.height-i}px)`}function setTranslateValue(e,t){e=getTranslateValue(e,t);e&&(t.style.webkitTransform=e,t.style.transform=e)}const defaultTimeout={enter:duration.enteringScreen,exit:duration.leavingScreen},Slide=React.forwardRef(function(e,t){const{children:n,direction:r="down",in:o,onEnter:i,onEntered:s,onEntering:a,onExit:p,onExited:l,onExiting:u,style:c,timeout:m=defaultTimeout,TransitionComponent:f=Transition}=e,d=_objectWithoutPropertiesLoose(e,["children","direction","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"]),T=useTheme(),y=React.useRef(null);var g=React.useCallback(e=>{y.current=ReactDOM.findDOMNode(e)},[]),x=useForkRef(n.ref,g);const E=useForkRef(x,t);var b=t=>e=>{t&&(void 0===e?t(y.current):t(y.current,e))},w=b((e,t)=>{setTranslateValue(r,e),reflow(e),i&&i(e,t)}),e=b((e,t)=>{var n=getTransitionProps({timeout:m,style:c},{mode:"enter"});e.style.webkitTransition=T.transitions.create("-webkit-transform",_extends({},n,{easing:T.transitions.easing.easeOut})),e.style.transition=T.transitions.create("transform",_extends({},n,{easing:T.transitions.easing.easeOut})),e.style.webkitTransform="none",e.style.transform="none",a&&a(e,t)}),g=b(s),x=b(u),t=b(e=>{var t=getTransitionProps({timeout:m,style:c},{mode:"exit"});e.style.webkitTransition=T.transitions.create("-webkit-transform",_extends({},t,{easing:T.transitions.easing.sharp})),e.style.transition=T.transitions.create("transform",_extends({},t,{easing:T.transitions.easing.sharp})),setTranslateValue(r,e),p&&p(e)}),b=b(e=>{e.style.webkitTransition="",e.style.transition="",l&&l(e)});const P=React.useCallback(()=>{y.current&&setTranslateValue(r,y.current)},[r]);return React.useEffect(()=>{if(!o&&"down"!==r&&"right"!==r){const e=debounce(()=>{y.current&&setTranslateValue(r,y.current)});return window.addEventListener("resize",e),()=>{e.clear(),window.removeEventListener("resize",e)}}},[r,o]),React.useEffect(()=>{o||P()},[o,P]),React.createElement(f,_extends({nodeRef:y,onEnter:w,onEntered:g,onEntering:e,onExit:t,onExited:b,onExiting:x,appear:!0,in:o,timeout:m},d),(e,t)=>React.cloneElement(n,_extends({ref:E,style:_extends({visibility:"exited"!==e||o?void 0:"hidden"},c,n.props.style)},t)))});"production"!==process.env.NODE_ENV&&(Slide.propTypes={children:elementAcceptingRef,direction:PropTypes.oneOf(["down","left","right","up"]),in:PropTypes.bool,onEnter:PropTypes.func,onEntered:PropTypes.func,onEntering:PropTypes.func,onExit:PropTypes.func,onExited:PropTypes.func,onExiting:PropTypes.func,style:PropTypes.object,timeout:PropTypes.oneOfType([PropTypes.number,PropTypes.shape({appear:PropTypes.number,enter:PropTypes.number,exit:PropTypes.number})])});export default Slide;export{setTranslateValue};