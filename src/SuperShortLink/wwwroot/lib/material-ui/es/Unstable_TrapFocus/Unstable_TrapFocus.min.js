import*as React from"react";import*as ReactDOM from"react-dom";import PropTypes from"prop-types";import ownerDocument from"../utils/ownerDocument";import useForkRef from"../utils/useForkRef";import{exactProp}from"@material-ui/utils";function Unstable_TrapFocus(e){const{children:t,disableAutoFocus:n=!1,disableEnforceFocus:c=!1,disableRestoreFocus:s=!1,getDoc:r,isEnabled:u,open:a}=e,i=React.useRef(),l=React.useRef(null),p=React.useRef(null),d=React.useRef(),f=React.useRef(null);e=React.useCallback(e=>{f.current=ReactDOM.findDOMNode(e)},[]),e=useForkRef(t.ref,e);const o=React.useRef();return React.useEffect(()=>{o.current=a},[a]),!o.current&&a&&"undefined"!=typeof window&&(d.current=r().activeElement),React.useEffect(()=>{if(a){const t=ownerDocument(f.current);n||!f.current||f.current.contains(t.activeElement)||(f.current.hasAttribute("tabIndex")||("production"!==process.env.NODE_ENV&&console.error(["Material-UI: The modal content node does not accept focus.",'For the benefit of assistive technologies, the tabIndex of the node is being set to "-1".'].join("\n")),f.current.setAttribute("tabIndex",-1)),f.current.focus());const e=()=>{var e=f["current"];null!==e&&(t.hasFocus()&&!c&&u()&&!i.current?f.current&&!f.current.contains(t.activeElement)&&f.current.focus():i.current=!1)},r=e=>{!c&&u()&&9===e.keyCode&&t.activeElement===f.current&&(i.current=!0,(e.shiftKey?p:l).current.focus())};t.addEventListener("focus",e,!0),t.addEventListener("keydown",r,!0);const o=setInterval(()=>{e()},50);return()=>{clearInterval(o),t.removeEventListener("focus",e,!0),t.removeEventListener("keydown",r,!0),s||(d.current&&d.current.focus&&d.current.focus(),d.current=null)}}},[n,c,s,u,a]),React.createElement(React.Fragment,null,React.createElement("div",{tabIndex:0,ref:l,"data-test":"sentinelStart"}),React.cloneElement(t,{ref:e}),React.createElement("div",{tabIndex:0,ref:p,"data-test":"sentinelEnd"}))}"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes={children:PropTypes.node,disableAutoFocus:PropTypes.bool,disableEnforceFocus:PropTypes.bool,disableRestoreFocus:PropTypes.bool,getDoc:PropTypes.func.isRequired,isEnabled:PropTypes.func.isRequired,open:PropTypes.bool.isRequired}),"production"!==process.env.NODE_ENV&&(Unstable_TrapFocus.propTypes=exactProp(Unstable_TrapFocus.propTypes));export default Unstable_TrapFocus;